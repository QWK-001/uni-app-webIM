{"version":3,"sources":["webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/msglist/msglist.vue?4ecd","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/msglist/msglist.vue?db94","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/msglist/msglist.vue?a6ae","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/msglist/msglist.vue?c8c5","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/msglist/msglist.vue","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/msglist/msglist.vue?dea0","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/msglist/msglist.vue?7312"],"names":["msgStorage","require","disp","LIST_STATUS","SHORT","NORMAL","page","Index","curMsgMid","isFail","data","view","toView","chatMsg","__visibility__","isIPX","components","audioMsg","props","username","type","Object","default","created","beforeMount","moved","destroyed","mounted","event","me","getApp","globalData","setData","myUsername","wx","getStorageSync","sessionKey","groupId","your","renderMsg","setStorageSync","on","err","mid","console","log","msgList","map","item","substring","length","msg","curChatMsg","isShow","renderableMsg","sesskey","info","from","to","methods","normalScroll","shortScroll","onTap","$emit","bubbles","previewImage","url","target","dataset","urls","getHistoryMsg","historyChatMsgs","timesMsgList","slice","concat","stopPullDownRefresh","isnew","elem","index","i","splice","item2","index2","pageScrollTo","scrollTop","renderFail","obj","callback","that","keys","val","forEach","key","split","$data","key2","$set"],"mappings":"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","file":"comps/chat/msglist/msglist.js","sourcesContent":["import { render, staticRenderFns } from \"./msglist.vue?vue&type=template&id=a1b8c4b4&\"\nimport script from \"./msglist.vue?vue&type=script&lang=js&\"\nexport * from \"./msglist.vue?vue&type=script&lang=js&\"\nimport style0 from \"./msglist.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('a1b8c4b4', component.options)\n    } else {\n      api.reload('a1b8c4b4', component.options)\n    }\n    module.hot.accept(\"./msglist.vue?vue&type=template&id=a1b8c4b4&\", function () {\n      api.rerender('a1b8c4b4', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/msglist/msglist.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./msglist.vue?vue&type=template&id=a1b8c4b4&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./msglist.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./msglist.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nlet msgStorage = require(\"../msgstorage\");\nlet disp = require(\"../../../utils/broadcast\");\nlet LIST_STATUS = {\n  SHORT: \"scroll_view_change\",\n  NORMAL: \"scroll_view\"\n};\nlet page = 0;\nlet Index = 0;\nlet curMsgMid = '';\nlet isFail = false;\nimport audioMsg from \"./type/audio/audio\";\n\nexport default {\n  data() {\n    return {\n      view: LIST_STATUS.NORMAL,\n      toView: \"\",\n      chatMsg: [],\n      __visibility__: false,\n      isIPX: false\n    };\n  },\n\n  components: {\n    audioMsg\n  },\n  props: {\n    username: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n\n  // lifetimes\n  created() {},\n\n  beforeMount() {\n    this.__visibility__ = true;\n    page = 0;\n    Index = 0;\n  },\n\n  moved() {},\n\n  destroyed() {\n    this.__visibility__ = false;\n  },\n\n  mounted(event) {\n    let me = this;\n\n    if (getApp().globalData.isIPX) {\n      this.setData({\n        isIPX: true\n      });\n    }\n\n    let username = this.username;\n    let myUsername = wx.getStorageSync(\"myUsername\");\n    let sessionKey = username.groupId ? username.groupId + myUsername : username.your + myUsername;\n    let chatMsg = wx.getStorageSync(sessionKey) || [];\n    this.renderMsg(null, null, chatMsg, sessionKey);\n    wx.setStorageSync(sessionKey, null); // disp.on(\"em.chat.sendSuccess\", function(mid){\n    // \tcurMsgMid = mid\n    // \tconsole.log('发送过去了', mid)\n    // \tlet msgList = me.data.chatMsg\n    // \tmsgList.map((item) =>{\n    // \t\tif (item.mid.substring(item.mid.length - 10) == mid.substring(mid.length - 10)) {\n    // \t\t\tconsole.log(111111, item)\n    // \t\t\titem.msg.data[0].isSuc = true\n    // \t\t\titem.isSuc = true\n    // \t\t\tme.setData({\n    // \t\t\t\tchatMsg: msgList\n    // \t\t\t})\n    // \t\t}\n    // \t})\n    // \tif (me.curChatMsg[0].mid == curMsgMid) {\n    // \t\tme.curChatMsg[0].msg.data[0].isShow = true\n    // \t\tme.curChatMsg[0].isShow = true\n    // \t}\n    // \twx.setStorageSync(\"rendered_\" + sessionKey, msgList);\n    // \tconsole.log('msgList', msgList)\n    // })\n\n    disp.on('em.xmpp.error.sendMsgErr', function (err) {\n      curMsgMid = err.data.mid;\n      isFail = true;\n      return;\n      console.log('发送失败了');\n      let msgList = me.chatMsg;\n      msgList.map(item => {\n        if (item.mid.substring(item.mid.length - 10) == curMsgMid.substring(curMsgMid.length - 10)) {\n          item.msg.data[0].isFail = true;\n          item.isFail = true;\n          me.setData({\n            chatMsg: msgList\n          });\n        }\n      });\n\n      if (me.curChatMsg[0].mid == curMsgMid) {\n        me.curChatMsg[0].msg.data[0].isShow = false;\n        me.curChatMsg[0].isShow = false;\n      }\n\n      wx.setStorageSync(\"rendered_\" + sessionKey, msgList);\n    });\n    msgStorage.on(\"newChatMsg\", function (renderableMsg, type, curChatMsg, sesskey) {\n      me.curChatMsg = curChatMsg;\n      if (!me.__visibility__) return; // 判断是否属于当前会话\n\n      if (username.groupId) {\n        // 群消息的 to 是 id，from 是 name\n        if (renderableMsg.info.from == username.groupId || renderableMsg.info.to == username.groupId) {\n          if (sesskey == sessionKey) {\n            me.renderMsg(renderableMsg, type, curChatMsg, sessionKey, 'newMsg');\n          }\n        }\n      } else if (renderableMsg.info.from == username.your || renderableMsg.info.to == username.your) {\n        if (sesskey == sessionKey) {\n          me.renderMsg(renderableMsg, type, curChatMsg, sessionKey, 'newMsg');\n        }\n      }\n    });\n  },\n\n  methods: {\n    normalScroll() {\n      this.setData({\n        view: LIST_STATUS.NORMAL\n      });\n    },\n\n    shortScroll() {\n      this.setData({\n        view: LIST_STATUS.SHORT\n      });\n    },\n\n    onTap() {\n      this.$emit(\"msglistTap\", null, {\n        bubbles: true\n      });\n    },\n\n    previewImage(event) {\n      var url = event.target.dataset.url;\n      wx.previewImage({\n        urls: [url] // 需要预览的图片 http 链接列表\n\n      });\n    },\n\n    getHistoryMsg() {\n      let me = this;\n      let username = this.username;\n      let myUsername = wx.getStorageSync(\"myUsername\");\n      let sessionKey = username.groupId ? username.groupId + myUsername : username.your + myUsername;\n      let historyChatMsgs = wx.getStorageSync(\"rendered_\" + sessionKey) || [];\n\n      if (Index < historyChatMsgs.length) {\n        let timesMsgList = historyChatMsgs.slice(-Index - 10, -Index);\n        this.setData({\n          chatMsg: timesMsgList.concat(me.chatMsg),\n          toView: timesMsgList[timesMsgList.length - 1].mid\n        });\n        Index += timesMsgList.length;\n\n        if (timesMsgList.length == 10) {\n          page++;\n        }\n\n        wx.stopPullDownRefresh();\n      }\n    },\n\n    renderMsg(renderableMsg, type, curChatMsg, sessionKey, isnew) {\n      let me = this;\n\n      if (curChatMsg.length > 1) {\n        this.chatMsg.map(function (elem, index) {\n          curChatMsg.map(function (item, i) {\n            if (elem.mid == item.mid) {\n              //me.data.chatMsg.splice(index, 1)\n              curChatMsg.splice(i, 1);\n            }\n          });\n        });\n      }\n\n      var historyChatMsgs = wx.getStorageSync(\"rendered_\" + sessionKey) || []; // if (curChatMsg.length) {\n      // \tconsole.log(curMsgMid.substring(curMsgMid.length - 10) , curChatMsg[0].mid.substring(curChatMsg[0].mid.length - 10))\n      // }\n      // if(curChatMsg.length && curMsgMid.substring(curMsgMid.length - 10) == curChatMsg[curChatMsg.length - 1].mid.substring(curChatMsg[0].mid.length - 10)){\n      // \t//curChatMsg[curChatMsg.length - 1].msg.data[0].isSuc = true\n      // \tcurChatMsg[curChatMsg.length - 1].isSuc = true\n      // }\n\n      historyChatMsgs = historyChatMsgs.concat(curChatMsg); //console.log('当前历史',renderableMsg)\n      //console.log('历史消息', historyChatMsgs)\n\n      if (!historyChatMsgs.length) return;\n\n      if (isnew == 'newMsg') {\n        this.setData({\n          chatMsg: this.chatMsg.concat(curChatMsg),\n          // 跳到最后一条\n          toView: historyChatMsgs[historyChatMsgs.length - 1].mid\n        });\n      } else {\n        this.setData({\n          chatMsg: historyChatMsgs.slice(-10),\n          // 跳到最后一条\n          toView: historyChatMsgs[historyChatMsgs.length - 1].mid\n        });\n      }\n\n      wx.setStorageSync(\"rendered_\" + sessionKey, historyChatMsgs);\n      let chatMsg = wx.getStorageSync(sessionKey) || [];\n      chatMsg.map(function (item, index) {\n        curChatMsg.map(function (item2, index2) {\n          if (item2.mid == item.mid) {\n            chatMsg.splice(index, 1);\n          }\n        });\n      });\n      wx.setStorageSync(sessionKey, chatMsg);\n      Index = historyChatMsgs.slice(-10).length;\n      wx.pageScrollTo({\n        scrollTop: 9999\n      });\n\n      if (isFail) {\n        this.renderFail(sessionKey);\n      }\n    },\n\n    renderFail(sessionKey) {\n      let me = this;\n      let msgList = me.chatMsg;\n      msgList.map(item => {\n        if (item.mid.substring(item.mid.length - 10) == curMsgMid.substring(curMsgMid.length - 10)) {\n          item.msg.data[0].isFail = true;\n          item.isFail = true;\n          me.setData({\n            chatMsg: msgList\n          });\n        }\n      });\n\n      if (me.curChatMsg[0].mid == curMsgMid) {\n        me.curChatMsg[0].msg.data[0].isShow = false;\n        me.curChatMsg[0].isShow = false;\n      }\n\n      wx.setStorageSync(\"rendered_\" + sessionKey, msgList);\n      isFail = false;\n    },\n\n    setData: function (obj, callback) {\n      let that = this;\n      let keys = [];\n      let val, data;\n      Object.keys(obj).forEach(function (key) {\n        keys = key.split('.');\n        val = obj[key];\n        data = that.$data;\n        keys.forEach(function (key2, index) {\n          if (index + 1 == keys.length) {\n            that.$set(data, key2, val);\n          } else {\n            if (!data[key2]) {\n              that.$set(data, key2, {});\n            }\n          }\n\n          data = data[key2];\n        });\n      });\n      callback && callback();\n    }\n  }\n};\n","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./msglist.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./msglist.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}