{"version":3,"sources":["webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/inputbar/suit/audio/audio.vue?b713","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/inputbar/suit/audio/audio.vue?6fff","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/inputbar/suit/audio/audio.vue?68d7","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/inputbar/suit/audio/audio.vue?2b2f","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/inputbar/suit/audio/audio.vue","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/inputbar/suit/audio/audio.vue?1cef","webpack:////Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/inputbar/suit/audio/audio.vue?5842"],"names":["WebIM","require","msgType","RECORD_CONST","RecordStatus","RecordDesc","disp","RunAnimation","InitHeight","data","changedTouches","recordStatus","HIDE","radomheight","recorderManager","wx","getRecorderManager","recordClicked","isLongPress","components","props","username","type","Object","default","chatType","String","SINGLE_CHAT","created","beforeMount","moved","destroyed","mounted","methods","toggleWithoutAction","e","toggleRecordModal","setData","SHOW","handleRecordingMove","touches","SWIPE","pageY","HOLD","handleRecording","me","setTimeout","executeRecord","getSetting","success","res","recordAuth","authSetting","openSetting","showToast","title","icon","startRecord","authorize","scope","fail","myradom","onStart","start","format","handleRecordingCancel","RELEASE","onStop","console","log","duration","uploadRecord","tempFilePath","stop","isGroupChat","CHAT_ROOM","getSendToParam","groupId","your","dur","str","config","appkey","split","token","conn","context","accessToken","uploadFile","url","filePath","name","header","Authorization","id","getUniqueId","msg","message","AUDIO","dataObj","JSON","parse","set","apiUrl","apiURL","body","uri","entities","uuid","filetype","filename","length","Math","ceil","from","myName","to","roomType","argument","fire","setGroup","send","$emit","bubbles","composed","that","_radomheight","i","random","toFixed","obj","callback","keys","val","forEach","key","$data","key2","index","$set"],"mappings":"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","file":"comps/chat/inputbar/suit/audio/audio.js","sourcesContent":["import { render, staticRenderFns } from \"./audio.vue?vue&type=template&id=e7bd8b50&\"\nimport script from \"./audio.vue?vue&type=script&lang=js&\"\nexport * from \"./audio.vue?vue&type=script&lang=js&\"\nimport style0 from \"./audio.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('e7bd8b50', component.options)\n    } else {\n      api.reload('e7bd8b50', component.options)\n    }\n    module.hot.accept(\"./audio.vue?vue&type=template&id=e7bd8b50&\", function () {\n      api.rerender('e7bd8b50', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"Users/lr/Documents/work/webim-weixin-xcx-ectype_uni/comps/chat/inputbar/suit/audio/audio.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./audio.vue?vue&type=template&id=e7bd8b50&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./audio.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./audio.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nlet WebIM = require(\"../../../../../utils/WebIM\")[\"default\"];\nlet msgType = require(\"../../../msgtype\");\nlet RECORD_CONST = require(\"./record_status\");\nlet RecordStatus = RECORD_CONST.RecordStatus;\nlet RecordDesc = RECORD_CONST.RecordDesc;\nlet disp = require(\"../../../../../utils/broadcast\");\nlet RunAnimation = false;\nconst InitHeight = [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50];\n\nexport default {\n  data() {\n    return {\n      changedTouches: null,\n      recordStatus: RecordStatus.HIDE,\n      RecordStatus,\n      RecordDesc,\n      // 模板中有引用\n      radomheight: InitHeight,\n      recorderManager: wx.getRecorderManager(),\n      recordClicked: false,\n      isLongPress: false\n    };\n  },\n\n  components: {},\n  props: {\n    username: {\n      type: Object,\n      default: () => ({})\n    },\n    chatType: {\n      type: String,\n      default: msgType.chatType.SINGLE_CHAT\n    }\n  },\n\n  // lifetimes\n  created() {},\n\n  beforeMount() {},\n\n  moved() {},\n\n  destroyed() {},\n\n  mounted() {},\n\n  methods: {\n    toggleWithoutAction(e) {// 阻止 tap 冒泡\n    },\n\n    toggleRecordModal() {\n      this.setData({\n        recordStatus: this.recordStatus == RecordStatus.HIDE ? RecordStatus.SHOW : RecordStatus.HIDE,\n        radomheight: InitHeight\n      });\n    },\n\n    handleRecordingMove(e) {\n      var touches = e.touches[0];\n      var changedTouches = this.changedTouches;\n\n      if (!changedTouches) {\n        return;\n      }\n\n      if (this.recordStatus == RecordStatus.SWIPE) {\n        if (changedTouches.pageY - touches.pageY < 20) {\n          this.setData({\n            recordStatus: RecordStatus.HOLD\n          });\n        }\n      }\n\n      if (this.recordStatus == RecordStatus.HOLD) {\n        if (changedTouches.pageY - touches.pageY > 20) {\n          this.setData({\n            recordStatus: RecordStatus.SWIPE\n          });\n        }\n      }\n    },\n\n    handleRecording(e) {\n      let me = this;\n      me.setData({\n        recordClicked: true\n      });\n      setTimeout(() => {\n        if (me.data.recordClicked == true) {\n          executeRecord();\n        }\n      }, 350);\n\n      function executeRecord() {\n        wx.getSetting({\n          success: res => {\n            let recordAuth = res.authSetting['scope.record'];\n\n            if (recordAuth == false) {\n              //已申请过授权，但是用户拒绝\n              wx.openSetting({\n                success: function (res) {\n                  let recordAuth = res.authSetting['scope.record'];\n\n                  if (recordAuth == true) {\n                    wx.showToast({\n                      title: \"授权成功\",\n                      icon: \"success\"\n                    });\n                  } else {\n                    wx.showToast({\n                      title: \"请授权录音\",\n                      icon: \"none\"\n                    });\n                  }\n\n                  me.setData({\n                    isLongPress: false\n                  });\n                }\n              });\n            } else if (recordAuth == true) {\n              // 用户已经同意授权\n              startRecord();\n            } else {\n              // 第一次进来，未发起授权\n              wx.authorize({\n                scope: 'scope.record',\n                success: () => {\n                  //授权成功\n                  wx.showToast({\n                    title: \"授权成功\",\n                    icon: \"success\"\n                  });\n                }\n              });\n            }\n          },\n          fail: function () {\n            wx.showToast({\n              title: \"鉴权失败，请重试\",\n              icon: \"none\"\n            });\n          }\n        });\n      }\n\n      function startRecord() {\n        me.data.changedTouches = e.touches[0];\n        me.setData({\n          recordStatus: RecordStatus.HOLD\n        });\n        RunAnimation = true;\n        me.myradom();\n        let recorderManager = me.data.recorderManager || wx.getRecorderManager();\n        recorderManager.onStart(() => {// console.log(\"开始录音...\");\n        });\n        recorderManager.start({\n          format: \"mp3\"\n        }); // 超时\n\n        setTimeout(function () {\n          me.handleRecordingCancel();\n          RunAnimation = false;\n        }, 100000);\n      }\n    },\n\n    handleRecordingCancel() {\n      RunAnimation = false;\n      let recorderManager = this.recorderManager; // 向上滑动状态停止：取消录音发放\n\n      if (this.recordStatus == RecordStatus.SWIPE) {\n        this.setData({\n          recordStatus: RecordStatus.RELEASE\n        });\n      } else {\n        this.setData({\n          recordStatus: RecordStatus.HIDE,\n          recordClicked: false\n        });\n      }\n\n      recorderManager.onStop(res => {\n        // console.log(\"结束录音...\", res);\n        if (this.recordStatus == RecordStatus.RELEASE) {\n          console.log(\"user canceled\");\n          this.setData({\n            recordStatus: RecordStatus.HIDE\n          });\n          return;\n        }\n\n        if (res.duration < 1000) {\n          wx.showToast({\n            title: \"录音时间太短\",\n            icon: \"none\"\n          });\n        } else {\n          // 上传\n          this.uploadRecord(res.tempFilePath, res.duration);\n        }\n      }); // 停止录音\n\n      recorderManager.stop();\n    },\n\n    isGroupChat() {\n      return this.chatType == msgType.chatType.CHAT_ROOM;\n    },\n\n    getSendToParam() {\n      return this.isGroupChat() ? this.username.groupId : this.username.your;\n    },\n\n    uploadRecord(tempFilePath, dur) {\n      var str = WebIM.config.appkey.split(\"#\");\n      var me = this;\n      var token = WebIM.conn.context.accessToken;\n      wx.uploadFile({\n        url: \"https://a1.easemob.com/\" + str[0] + \"/\" + str[1] + \"/chatfiles\",\n        filePath: tempFilePath,\n        name: \"file\",\n        header: {\n          \"Content-Type\": \"multipart/form-data\",\n          Authorization: \"Bearer \" + token\n        },\n\n        success(res) {\n          // 发送 xmpp 消息\n          var id = WebIM.conn.getUniqueId();\n          var msg = new WebIM.message(msgType.AUDIO, id);\n          var dataObj = JSON.parse(res.data); // 接收消息对象\n\n          msg.set({\n            apiUrl: WebIM.config.apiURL,\n            accessToken: token,\n            body: {\n              type: msgType.AUDIO,\n              url: dataObj.uri + \"/\" + dataObj.entities[0].uuid,\n              filetype: \"\",\n              filename: tempFilePath,\n              accessToken: token,\n              length: Math.ceil(dur / 1000)\n            },\n            from: me.data.username.myName,\n            to: me.getSendToParam(),\n            roomType: false,\n            chatType: me.data.chatType,\n            success: function (argument) {\n              disp.fire('em.chat.sendSuccess', id);\n            }\n          });\n\n          if (me.isGroupChat()) {\n            msg.setGroup(\"groupchat\");\n          }\n\n          msg.body.length = Math.ceil(dur / 1000); //console.log('发送的语音消息', msg.body)\n\n          WebIM.conn.send(msg.body);\n          me.$emit(\"newAudioMsg\", {\n            msg: msg,\n            type: msgType.AUDIO\n          }, {\n            bubbles: true,\n            composed: true\n          });\n        }\n\n      });\n    },\n\n    myradom() {\n      const that = this;\n      var _radomheight = that.radomheight;\n\n      for (var i = 0; i < that.radomheight.length; i++) {\n        //+1是为了避免为0\n        _radomheight[i] = 100 * Math.random().toFixed(2) + 10;\n      }\n\n      that.setData({\n        radomheight: _radomheight\n      });\n\n      if (RunAnimation) {\n        setTimeout(function () {\n          that.myradom();\n        }, 500);\n      } else {\n        return;\n      }\n    },\n\n    setData: function (obj, callback) {\n      let that = this;\n      let keys = [];\n      let val, data;\n      Object.keys(obj).forEach(function (key) {\n        keys = key.split('.');\n        val = obj[key];\n        data = that.$data;\n        keys.forEach(function (key2, index) {\n          if (index + 1 == keys.length) {\n            that.$set(data, key2, val);\n          } else {\n            if (!data[key2]) {\n              that.$set(data, key2, {});\n            }\n          }\n\n          data = data[key2];\n        });\n      });\n      callback && callback();\n    }\n  }\n};\n","import mod from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./audio.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./audio.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}